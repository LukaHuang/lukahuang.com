<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.7.1 by Michael Rose
  Copyright 2017 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">

<head>
  <meta charset="utf-8">

<!-- begin SEO -->









<title>EDX Linux Foundation Ch 9：User Environment Section 1 Account - LukaHuang.com</title>




<meta name="description" content="Section 1 Account1. Identifying the Current UserwhoTo list the currently logged-on users, type whowhoamiTo identify the current user, type whoamiwho -aGiving who the -a option will give more detailed information.2. Basics of Users and GroupsLinux uses groups for organizing users. Groups are collections of accounts with certain shared permissions.UID and GIDAll Linux users are assigned a unique user ID (uid), which is just an integer, as well as one or more group ID’s (gid), including a default one which is the same as the user ID./etc/passwd這個檔案的構造是這樣的：每一行都代表一個帳號，有幾行就代表有幾個帳號在你的系統中！ 不過需要特別留意的是，裡頭很多帳號本來就是系統正常運作所必須要的，我們可以簡稱他為系統帳號， 例如 bin, daemon, adm, nobody 等等，這些帳號請不要隨意的殺掉他ubuntu@ip-172-31-27-94:~$ head -n 4 /etc/passwdroot:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologinbin:x:2:2:bin:/bin:/usr/sbin/nologinsys:x:3:3:sys:/dev:/usr/sbin/nologin      帳號名稱：就是帳號啦！用來對應 UID 的。例如 root 的 UID 對應就是 0 (第三欄位)；        密碼：早期 Unix 系統的密碼就是放在這欄位上！但是因為這個檔案的特性是所有的程序都能夠讀取，這樣一來很容易造成密碼資料被竊取， 因此後來就將這個欄位的密碼資料給他改放到 /etc/shadow 中了。所以這裡你會看到一個『 x 』！        UID：    GID這個與 /etc/group 有關！其實 /etc/group 的觀念與 /etc/passwd 差不多，只是他是用來規範群組名稱與 GID 的對應而已！  使用者資訊說明欄這個欄位基本上並沒有什麼重要用途，只是用來解釋這個帳號的意義而已  家目錄root 的家目錄在 /root預設的使用者家目錄在 /home/yourIDname  Shell當使用者登入系統後就會取得一個 Shell 來與系統的核心溝通以進行使用者的操作任務。那為何預設 shell 會使用 bash 呢？就是在這個欄位指定的囉！ 這裡比較需要注意的是，有一個 shell 可以用來替代成讓帳號無法取得 shell 環境的登入動作！那就是 /sbin/nologin 這個東西！這也可以用來製作純 pop 郵件帳號者的資料呢！/etc/shadow早期的密碼也有加密過，但卻放置到 /etc/passwd 的第二個欄位上！這樣一來很容易被有心人士所竊取的， 加密過的密碼也能夠透過暴力破解法去 try and error (試誤) 找出來！因為這樣的關係，所以後來發展出將密碼移動到 /etc/shadow 這個檔案分隔開來的技術， 而且還加入很多的密碼限制參數在 /etc/shadow 裡頭呢詳細內容請看：鳥哥：/etc/shadow 檔案結構/etc/groupControl of group membership is administered through the /etc/group file, which shows a list of groups and their members.ubuntu@ip-172-31-27-94:~$ head -n 4 /etc/grouproot:x:0:daemon:x:1:bin:x:2:sys:x:3:這個檔案每一行代表一個群組，也是以冒號『:』作為欄位的分隔符號，共分為四欄，每一欄位的意義是：      群組名稱：就是群組名稱啦！        群組密碼：通常不需要設定，這個設定通常是給『群組管理員』使用的，目前很少有這個機會設定群組管理員啦！ 同樣的，密碼已經移動到 /etc/gshadow 去，因此這個欄位只會存在一個『x』而已；        GID：就是群組的 ID 啊。我們 /etc/passwd 第四個欄位使用的 GID 對應的群組名，就是由這裡對應出來的！        此群組支援的帳號名稱：我們知道一個帳號可以加入多個群組，那某個帳號想要加入此群組時，將該帳號填入這個欄位即可。 舉例來說，如果我想要讓 dmtsai 也加入 root 這個群組，那麼在第一行的最後面加上『,dmtsai』，注意不要有空格， 使成為『 root:x:0:root,dmtsai 』就可以囉～  3. Adding and Removing UsersOnly the root user can add and remove users and groups.useraddIn the simplest form an account for the new user turkey would be done with:$ sudo useradd turkeywhich by default sets the home directory to /home/turkey, populates it with some basic files (copied from /etc/skel) and adds a line to /etc/passwd such as:turkey:x:502:502::/home/turkey:/bin/bashand sets the default shell to /bin/bashuserdel and userdel -rRemoving a user account is as easy as typing userdel turkey However, this will leave the /home/turkey directory intact. This might be useful if it is a temporary inactivation. To remove the home directory while removing the account one needs to use the -r option to userdel.idTyping id with no argument gives information about the current user, as in:$ iduid=500(george) gid=500(george) groups=106(fuse),500(george)If given the name of another user as an argument, id will report information about that other user.usermod所謂這『人有失手，馬有亂蹄』，您說是吧？所以囉，當然有的時候會『不小心』在 useradd 的時候加入了錯誤的設定資料。或者是，在使用 useradd 後，發現某些地方還可以進行細部修改。 此時，當然我們可以直接到 /etc/passwd 或 /etc/shadow 去修改相對應欄位的資料， 不過，Linux 也有提供相關的指令讓大家來進行帳號相關資料的微調呢～那就是 usermod 囉～鳥哥：usermod4. Adding and Removing GroupsgroupaddAdding a new group is done with groupadd:$ sudo /usr/sbin/groupadd anewgroupgroupdelThe group can be removed with$ sudo /usr/sbin/groupdel anewgroupgroups輸入groups turkey查看turkey的group$groups turkeyturkey : turkey得到turkey : turkey，代表預設的群組是自己。使用usermod修改群組Adding a user to an already existing group is done with usermod.$ sudo /usr/sbin/usermod -G anewgroup turkey$ groups turkeyturkey: turkey anewgroup-g  ：後面接初始群組，修改 /etc/passwd 的第四個欄位，亦即是 GID 的欄位！-G  ：後面接次要群組，修改這個使用者能夠支援的群組，修改的是 /etc/group 囉～5. The root AccountThe root account is very powerful and has full access to the system. Other operating systems often call this the administrator account; in Linux it is often called the superuser account.suswitch or substitute usersudosudo 可以讓你以其他用戶的身份執行指令 (通常是使用 root 的身份來執行指令)/etc/sudoerssudo configuration files are stored in the /etc/sudoers file and in the /etc/sudoers.d/ directory. By default, the sudoers.d directory is empty.6.Startup Files/etcIn Linux, the command shell program (generally bash)  uses one or more startup files to configure the environment. Files in the /etc directory define global settings for all users while Initialization files in the user’s home directory can include and/or override the global settings./etc/profile(login shell reading it)When you first login to Linux, /etc/profile is read and evaluated, after which the following files are searched (if they exist) in the listed order:  ~/.bash_profile  ~/.bash_login  ~/.profileThe Linux login shell evaluates whatever startup file that it comes across first and ignores the rest. This means that if it finds ~/.bash_profile, it ignores ~/.bash_login and ~/.profile. Different distributions may use different startup files.~/.bashrc (non-login shell reading it)However, every time you create a new shell, or terminal window, etc., you do not perform a full system login; only the ~/.bashrc file is read and evaluated.~/.bash_history還記得我們在歷史命令提到過這個檔案吧？預設的情況下， 我們的歷史命令就記錄在這裡啊！而這個檔案能夠記錄幾筆資料，則與 HISTFILESIZE 這個變數有關啊。每次登入 bash 後，bash 會先讀取這個檔案，將所有的歷史指令讀入記憶體， 因此，當我們登入 bash 後就可以查知上次使用過哪些指令囉。至於更多的歷史指令， 請自行回去參考喔！login shell 和 no-login shell“login shell” 代表用戶登入, 比如使用“su -“ 命令, 或者用ssh 連接到某一個服務器上, 都會使用該用戶默認shell 啟動login shell 模式.該模式下的shell會去自動執行/etc/profile和~/.profile文件,但不會執行任何的bashrc文件,所以一般再/etc/profile或者~/.profile裡我們會手動去source bashrc文件.而no-login shell 的情況是我們在終端下直接輸入bash 或者bash -c “CMD” 來啟動的shell.該模式下是不會自動去運行任何的profile 文件.">




<meta name="author" content="Luka">

<meta property="og:locale" content="en">
<meta property="og:site_name" content="LukaHuang.com">
<meta property="og:title" content="EDX Linux Foundation Ch 9：User Environment Section 1 Account">


  <link rel="canonical" href="https://lukahuang.com/edx-linux-foundation-ch-9/">
  <meta property="og:url" content="https://lukahuang.com/edx-linux-foundation-ch-9/">



  <meta property="og:description" content="Section 1 Account1. Identifying the Current UserwhoTo list the currently logged-on users, type whowhoamiTo identify the current user, type whoamiwho -aGiving who the -a option will give more detailed information.2. Basics of Users and GroupsLinux uses groups for organizing users. Groups are collections of accounts with certain shared permissions.UID and GIDAll Linux users are assigned a unique user ID (uid), which is just an integer, as well as one or more group ID’s (gid), including a default one which is the same as the user ID./etc/passwd這個檔案的構造是這樣的：每一行都代表一個帳號，有幾行就代表有幾個帳號在你的系統中！ 不過需要特別留意的是，裡頭很多帳號本來就是系統正常運作所必須要的，我們可以簡稱他為系統帳號， 例如 bin, daemon, adm, nobody 等等，這些帳號請不要隨意的殺掉他ubuntu@ip-172-31-27-94:~$ head -n 4 /etc/passwdroot:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologinbin:x:2:2:bin:/bin:/usr/sbin/nologinsys:x:3:3:sys:/dev:/usr/sbin/nologin      帳號名稱：就是帳號啦！用來對應 UID 的。例如 root 的 UID 對應就是 0 (第三欄位)；        密碼：早期 Unix 系統的密碼就是放在這欄位上！但是因為這個檔案的特性是所有的程序都能夠讀取，這樣一來很容易造成密碼資料被竊取， 因此後來就將這個欄位的密碼資料給他改放到 /etc/shadow 中了。所以這裡你會看到一個『 x 』！        UID：    GID這個與 /etc/group 有關！其實 /etc/group 的觀念與 /etc/passwd 差不多，只是他是用來規範群組名稱與 GID 的對應而已！  使用者資訊說明欄這個欄位基本上並沒有什麼重要用途，只是用來解釋這個帳號的意義而已  家目錄root 的家目錄在 /root預設的使用者家目錄在 /home/yourIDname  Shell當使用者登入系統後就會取得一個 Shell 來與系統的核心溝通以進行使用者的操作任務。那為何預設 shell 會使用 bash 呢？就是在這個欄位指定的囉！ 這裡比較需要注意的是，有一個 shell 可以用來替代成讓帳號無法取得 shell 環境的登入動作！那就是 /sbin/nologin 這個東西！這也可以用來製作純 pop 郵件帳號者的資料呢！/etc/shadow早期的密碼也有加密過，但卻放置到 /etc/passwd 的第二個欄位上！這樣一來很容易被有心人士所竊取的， 加密過的密碼也能夠透過暴力破解法去 try and error (試誤) 找出來！因為這樣的關係，所以後來發展出將密碼移動到 /etc/shadow 這個檔案分隔開來的技術， 而且還加入很多的密碼限制參數在 /etc/shadow 裡頭呢詳細內容請看：鳥哥：/etc/shadow 檔案結構/etc/groupControl of group membership is administered through the /etc/group file, which shows a list of groups and their members.ubuntu@ip-172-31-27-94:~$ head -n 4 /etc/grouproot:x:0:daemon:x:1:bin:x:2:sys:x:3:這個檔案每一行代表一個群組，也是以冒號『:』作為欄位的分隔符號，共分為四欄，每一欄位的意義是：      群組名稱：就是群組名稱啦！        群組密碼：通常不需要設定，這個設定通常是給『群組管理員』使用的，目前很少有這個機會設定群組管理員啦！ 同樣的，密碼已經移動到 /etc/gshadow 去，因此這個欄位只會存在一個『x』而已；        GID：就是群組的 ID 啊。我們 /etc/passwd 第四個欄位使用的 GID 對應的群組名，就是由這裡對應出來的！        此群組支援的帳號名稱：我們知道一個帳號可以加入多個群組，那某個帳號想要加入此群組時，將該帳號填入這個欄位即可。 舉例來說，如果我想要讓 dmtsai 也加入 root 這個群組，那麼在第一行的最後面加上『,dmtsai』，注意不要有空格， 使成為『 root:x:0:root,dmtsai 』就可以囉～  3. Adding and Removing UsersOnly the root user can add and remove users and groups.useraddIn the simplest form an account for the new user turkey would be done with:$ sudo useradd turkeywhich by default sets the home directory to /home/turkey, populates it with some basic files (copied from /etc/skel) and adds a line to /etc/passwd such as:turkey:x:502:502::/home/turkey:/bin/bashand sets the default shell to /bin/bashuserdel and userdel -rRemoving a user account is as easy as typing userdel turkey However, this will leave the /home/turkey directory intact. This might be useful if it is a temporary inactivation. To remove the home directory while removing the account one needs to use the -r option to userdel.idTyping id with no argument gives information about the current user, as in:$ iduid=500(george) gid=500(george) groups=106(fuse),500(george)If given the name of another user as an argument, id will report information about that other user.usermod所謂這『人有失手，馬有亂蹄』，您說是吧？所以囉，當然有的時候會『不小心』在 useradd 的時候加入了錯誤的設定資料。或者是，在使用 useradd 後，發現某些地方還可以進行細部修改。 此時，當然我們可以直接到 /etc/passwd 或 /etc/shadow 去修改相對應欄位的資料， 不過，Linux 也有提供相關的指令讓大家來進行帳號相關資料的微調呢～那就是 usermod 囉～鳥哥：usermod4. Adding and Removing GroupsgroupaddAdding a new group is done with groupadd:$ sudo /usr/sbin/groupadd anewgroupgroupdelThe group can be removed with$ sudo /usr/sbin/groupdel anewgroupgroups輸入groups turkey查看turkey的group$groups turkeyturkey : turkey得到turkey : turkey，代表預設的群組是自己。使用usermod修改群組Adding a user to an already existing group is done with usermod.$ sudo /usr/sbin/usermod -G anewgroup turkey$ groups turkeyturkey: turkey anewgroup-g  ：後面接初始群組，修改 /etc/passwd 的第四個欄位，亦即是 GID 的欄位！-G  ：後面接次要群組，修改這個使用者能夠支援的群組，修改的是 /etc/group 囉～5. The root AccountThe root account is very powerful and has full access to the system. Other operating systems often call this the administrator account; in Linux it is often called the superuser account.suswitch or substitute usersudosudo 可以讓你以其他用戶的身份執行指令 (通常是使用 root 的身份來執行指令)/etc/sudoerssudo configuration files are stored in the /etc/sudoers file and in the /etc/sudoers.d/ directory. By default, the sudoers.d directory is empty.6.Startup Files/etcIn Linux, the command shell program (generally bash)  uses one or more startup files to configure the environment. Files in the /etc directory define global settings for all users while Initialization files in the user’s home directory can include and/or override the global settings./etc/profile(login shell reading it)When you first login to Linux, /etc/profile is read and evaluated, after which the following files are searched (if they exist) in the listed order:  ~/.bash_profile  ~/.bash_login  ~/.profileThe Linux login shell evaluates whatever startup file that it comes across first and ignores the rest. This means that if it finds ~/.bash_profile, it ignores ~/.bash_login and ~/.profile. Different distributions may use different startup files.~/.bashrc (non-login shell reading it)However, every time you create a new shell, or terminal window, etc., you do not perform a full system login; only the ~/.bashrc file is read and evaluated.~/.bash_history還記得我們在歷史命令提到過這個檔案吧？預設的情況下， 我們的歷史命令就記錄在這裡啊！而這個檔案能夠記錄幾筆資料，則與 HISTFILESIZE 這個變數有關啊。每次登入 bash 後，bash 會先讀取這個檔案，將所有的歷史指令讀入記憶體， 因此，當我們登入 bash 後就可以查知上次使用過哪些指令囉。至於更多的歷史指令， 請自行回去參考喔！login shell 和 no-login shell“login shell” 代表用戶登入, 比如使用“su -“ 命令, 或者用ssh 連接到某一個服務器上, 都會使用該用戶默認shell 啟動login shell 模式.該模式下的shell會去自動執行/etc/profile和~/.profile文件,但不會執行任何的bashrc文件,所以一般再/etc/profile或者~/.profile裡我們會手動去source bashrc文件.而no-login shell 的情況是我們在終端下直接輸入bash 或者bash -c “CMD” 來啟動的shell.該模式下是不會自動去運行任何的profile 文件.">

















  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2014-09-13T07:50:00+00:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Luka Huang",
      "url" : "https://lukahuang.com",
      "sameAs" : null
    }
  </script>







<!-- end SEO -->


<link href="https://lukahuang.com/feed.xml" type="application/atom+xml" rel="alternate" title="LukaHuang.com Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="https://lukahuang.com/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


  <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->




  <script>
  window['_fs_debug'] = false;
  window['_fs_host'] = 'fullstory.com';
  window['_fs_org'] = '99AG5';
  window['_fs_namespace'] = 'FS';
  (function(m,n,e,t,l,o,g,y){
      if (e in m) {if(m.console && m.console.log) { m.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].');} return;}
      g=m[e]=function(a,b){g.q?g.q.push([a,b]):g._api(a,b);};g.q=[];
      o=n.createElement(t);o.async=1;o.src='https://'+_fs_host+'/s/fs.js';
      y=n.getElementsByTagName(t)[0];y.parentNode.insertBefore(o,y);
      g.identify=function(i,v){g(l,{uid:i});if(v)g(l,v)};g.setUserVars=function(v){g(l,v)};
      g.identifyAccount=function(i,v){o='account';v=v||{};v.acctId=i;g(o,v)};
      g.clearUserCookie=function(c,d,i){if(!c || document.cookie.match('fs_uid=[`;`]*`[`;`]*`[`;`]*`')){
      d=n.domain;while(1){n.cookie='fs_uid=;domain='+d+
      ';path=/;expires='+new Date(0).toUTCString();i=d.indexOf('.');if(i<0)break;d=d.slice(i+1)}}};
  })(window,document,window['_fs_namespace'],'script','user');
</script>
</head>

<body class="layout--single">

  <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

  <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="https://lukahuang.com/">LukaHuang.com</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item"><a href="https://lukahuang.com/archives/">Archives</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://lukahuang.com/tags/">Tags</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://lukahuang.com/search/">Search</a></li>
          
        </ul>
        <button type="button">
          <span class="visually-hidden">Toggle Menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

  



<div id="main" role="main">

  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="EDX Linux Foundation Ch 9：User Environment Section 1 Account">
    <meta itemprop="description" content="Section 1 Account1. Identifying the Current UserwhoTo list the currently logged-on users, type whowhoamiTo identify the current user, type whoamiwho -aGiving who the -a option will give more detailed information.2. Basics of Users and GroupsLinux uses groups for organizing users. Groups are collections of accounts with certain shared permissions.UID and GIDAll Linux users are assigned a unique user ID (uid), which is just an integer, as well as one or more group ID’s (gid), including a default one which is the same as the user ID./etc/passwd這個檔案的構造是這樣的：每一行都代表一個帳號，有幾行就代表有幾個帳號在你的系統中！ 不過需要特別留意的是，裡頭很多帳號本來就是系統正常運作所必須要的，我們可以簡稱他為系統帳號， 例如 bin, daemon, adm, nobody 等等，這些帳號請不要隨意的殺掉他ubuntu@ip-172-31-27-94:~$ head -n 4 /etc/passwdroot:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologinbin:x:2:2:bin:/bin:/usr/sbin/nologinsys:x:3:3:sys:/dev:/usr/sbin/nologin      帳號名稱：就是帳號啦！用來對應 UID 的。例如 root 的 UID 對應就是 0 (第三欄位)；        密碼：早期 Unix 系統的密碼就是放在這欄位上！但是因為這個檔案的特性是所有的程序都能夠讀取，這樣一來很容易造成密碼資料被竊取， 因此後來就將這個欄位的密碼資料給他改放到 /etc/shadow 中了。所以這裡你會看到一個『 x 』！        UID：    GID這個與 /etc/group 有關！其實 /etc/group 的觀念與 /etc/passwd 差不多，只是他是用來規範群組名稱與 GID 的對應而已！  使用者資訊說明欄這個欄位基本上並沒有什麼重要用途，只是用來解釋這個帳號的意義而已  家目錄root 的家目錄在 /root預設的使用者家目錄在 /home/yourIDname  Shell當使用者登入系統後就會取得一個 Shell 來與系統的核心溝通以進行使用者的操作任務。那為何預設 shell 會使用 bash 呢？就是在這個欄位指定的囉！ 這裡比較需要注意的是，有一個 shell 可以用來替代成讓帳號無法取得 shell 環境的登入動作！那就是 /sbin/nologin 這個東西！這也可以用來製作純 pop 郵件帳號者的資料呢！/etc/shadow早期的密碼也有加密過，但卻放置到 /etc/passwd 的第二個欄位上！這樣一來很容易被有心人士所竊取的， 加密過的密碼也能夠透過暴力破解法去 try and error (試誤) 找出來！因為這樣的關係，所以後來發展出將密碼移動到 /etc/shadow 這個檔案分隔開來的技術， 而且還加入很多的密碼限制參數在 /etc/shadow 裡頭呢詳細內容請看：鳥哥：/etc/shadow 檔案結構/etc/groupControl of group membership is administered through the /etc/group file, which shows a list of groups and their members.ubuntu@ip-172-31-27-94:~$ head -n 4 /etc/grouproot:x:0:daemon:x:1:bin:x:2:sys:x:3:這個檔案每一行代表一個群組，也是以冒號『:』作為欄位的分隔符號，共分為四欄，每一欄位的意義是：      群組名稱：就是群組名稱啦！        群組密碼：通常不需要設定，這個設定通常是給『群組管理員』使用的，目前很少有這個機會設定群組管理員啦！ 同樣的，密碼已經移動到 /etc/gshadow 去，因此這個欄位只會存在一個『x』而已；        GID：就是群組的 ID 啊。我們 /etc/passwd 第四個欄位使用的 GID 對應的群組名，就是由這裡對應出來的！        此群組支援的帳號名稱：我們知道一個帳號可以加入多個群組，那某個帳號想要加入此群組時，將該帳號填入這個欄位即可。 舉例來說，如果我想要讓 dmtsai 也加入 root 這個群組，那麼在第一行的最後面加上『,dmtsai』，注意不要有空格， 使成為『 root:x:0:root,dmtsai 』就可以囉～  3. Adding and Removing UsersOnly the root user can add and remove users and groups.useraddIn the simplest form an account for the new user turkey would be done with:$ sudo useradd turkeywhich by default sets the home directory to /home/turkey, populates it with some basic files (copied from /etc/skel) and adds a line to /etc/passwd such as:turkey:x:502:502::/home/turkey:/bin/bashand sets the default shell to /bin/bashuserdel and userdel -rRemoving a user account is as easy as typing userdel turkey However, this will leave the /home/turkey directory intact. This might be useful if it is a temporary inactivation. To remove the home directory while removing the account one needs to use the -r option to userdel.idTyping id with no argument gives information about the current user, as in:$ iduid=500(george) gid=500(george) groups=106(fuse),500(george)If given the name of another user as an argument, id will report information about that other user.usermod所謂這『人有失手，馬有亂蹄』，您說是吧？所以囉，當然有的時候會『不小心』在 useradd 的時候加入了錯誤的設定資料。或者是，在使用 useradd 後，發現某些地方還可以進行細部修改。 此時，當然我們可以直接到 /etc/passwd 或 /etc/shadow 去修改相對應欄位的資料， 不過，Linux 也有提供相關的指令讓大家來進行帳號相關資料的微調呢～那就是 usermod 囉～鳥哥：usermod4. Adding and Removing GroupsgroupaddAdding a new group is done with groupadd:$ sudo /usr/sbin/groupadd anewgroupgroupdelThe group can be removed with$ sudo /usr/sbin/groupdel anewgroupgroups輸入groups turkey查看turkey的group$groups turkeyturkey : turkey得到turkey : turkey，代表預設的群組是自己。使用usermod修改群組Adding a user to an already existing group is done with usermod.$ sudo /usr/sbin/usermod -G anewgroup turkey$ groups turkeyturkey: turkey anewgroup-g  ：後面接初始群組，修改 /etc/passwd 的第四個欄位，亦即是 GID 的欄位！-G  ：後面接次要群組，修改這個使用者能夠支援的群組，修改的是 /etc/group 囉～5. The root AccountThe root account is very powerful and has full access to the system. Other operating systems often call this the administrator account; in Linux it is often called the superuser account.suswitch or substitute usersudosudo 可以讓你以其他用戶的身份執行指令 (通常是使用 root 的身份來執行指令)/etc/sudoerssudo configuration files are stored in the /etc/sudoers file and in the /etc/sudoers.d/ directory. By default, the sudoers.d directory is empty.6.Startup Files/etcIn Linux, the command shell program (generally bash)  uses one or more startup files to configure the environment. Files in the /etc directory define global settings for all users while Initialization files in the user’s home directory can include and/or override the global settings./etc/profile(login shell reading it)When you first login to Linux, /etc/profile is read and evaluated, after which the following files are searched (if they exist) in the listed order:  ~/.bash_profile  ~/.bash_login  ~/.profileThe Linux login shell evaluates whatever startup file that it comes across first and ignores the rest. This means that if it finds ~/.bash_profile, it ignores ~/.bash_login and ~/.profile. Different distributions may use different startup files.~/.bashrc (non-login shell reading it)However, every time you create a new shell, or terminal window, etc., you do not perform a full system login; only the ~/.bashrc file is read and evaluated.~/.bash_history還記得我們在歷史命令提到過這個檔案吧？預設的情況下， 我們的歷史命令就記錄在這裡啊！而這個檔案能夠記錄幾筆資料，則與 HISTFILESIZE 這個變數有關啊。每次登入 bash 後，bash 會先讀取這個檔案，將所有的歷史指令讀入記憶體， 因此，當我們登入 bash 後就可以查知上次使用過哪些指令囉。至於更多的歷史指令， 請自行回去參考喔！login shell 和 no-login shell“login shell” 代表用戶登入, 比如使用“su -“ 命令, 或者用ssh 連接到某一個服務器上, 都會使用該用戶默認shell 啟動login shell 模式.該模式下的shell會去自動執行/etc/profile和~/.profile文件,但不會執行任何的bashrc文件,所以一般再/etc/profile或者~/.profile裡我們會手動去source bashrc文件.而no-login shell 的情況是我們在終端下直接輸入bash 或者bash -c “CMD” 來啟動的shell.該模式下是不會自動去運行任何的profile 文件.">
    <meta itemprop="datePublished" content="September 13, 2014">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">EDX Linux Foundation Ch 9：User Environment Section 1 Account
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fa fa-file-text"></i> Outline</h4></header>
              <ul class="toc__menu">
  <li>
<a href="#1-identifying-the-current-user">1. Identifying the Current User</a>
    <ul>
      <li><a href="#who">who</a></li>
      <li><a href="#whoami">whoami</a></li>
      <li><a href="#who--a">who -a</a></li>
      <li><a href="#uid-and-gid">UID and GID</a></li>
      <li><a href="#etcpasswd">/etc/passwd</a></li>
      <li><a href="#etcshadow">/etc/shadow</a></li>
      <li><a href="#etcgroup">/etc/group</a></li>
      <li><a href="#useradd">useradd</a></li>
      <li><a href="#userdel-and-userdel--r">userdel and userdel -r</a></li>
      <li><a href="#id">id</a></li>
      <li><a href="#usermod">usermod</a></li>
      <li><a href="#groupadd">groupadd</a></li>
      <li><a href="#groupdel">groupdel</a></li>
      <li><a href="#groups">groups</a></li>
      <li><a href="#%E4%BD%BF%E7%94%A8usermod%E4%BF%AE%E6%94%B9%E7%BE%A4%E7%B5%84">使用usermod修改群組</a></li>
      <li><a href="#su">su</a></li>
      <li><a href="#sudo">sudo</a></li>
      <li><a href="#etcsudoers">/etc/sudoers</a></li>
      <li><a href="#etc">/etc</a></li>
      <li><a href="#etcprofilelogin-shell-reading-it">/etc/profile(login shell reading it)</a></li>
      <li><a href="#bashrc-non-login-shell-reading-it">~/.bashrc (non-login shell reading it)</a></li>
      <li><a href="#bash_history">~/.bash_history</a></li>
    </ul>
  </li>
  <li><a href="#login-shell-%E5%92%8C-no-login-shell">login shell 和 no-login shell</a></li>
</ul>
            </nav>
          </aside>
        
        <h1 id="section-1-account">Section 1 Account</h1>

<h2 id="1-identifying-the-current-user">1. Identifying the Current User</h2>
<h3 id="who">who</h3>
<p>To list the currently logged-on users, type <code class="highlighter-rouge">who</code></p>
<h3 id="whoami">whoami</h3>
<p>To identify the current user, type <code class="highlighter-rouge">whoami</code></p>
<h3 id="who--a">who -a</h3>
<p>Giving <code class="highlighter-rouge">who</code> the <code class="highlighter-rouge">-a</code> option will give more detailed information.</p>

<h1 id="2-basics-of-users-and-groups">2. Basics of Users and Groups</h1>

<p>Linux uses groups for organizing users. Groups are collections of accounts with certain shared permissions.</p>

<h3 id="uid-and-gid">UID and GID</h3>

<p>All Linux users are assigned a unique user ID (<code class="highlighter-rouge">uid</code>), which is just an integer, as well as one or more group ID’s (gid), including a default one which is the same as the user ID.</p>

<h3 id="etcpasswd"><code class="highlighter-rouge">/etc/passwd</code></h3>
<p>這個檔案的構造是這樣的：每一行都代表一個帳號，有幾行就代表有幾個帳號在你的系統中！ 不過需要特別留意的是，裡頭很多帳號本來就是系統正常運作所必須要的，我們可以簡稱他為系統帳號， 例如 bin, daemon, adm, nobody 等等，這些帳號請不要隨意的殺掉他</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ubuntu@ip-172-31-27-94:~$ head -n 4 /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
</code></pre></div></div>
<ol>
  <li>
    <p>帳號名稱：
就是帳號啦！用來對應 UID 的。例如 root 的 UID 對應就是 0 (第三欄位)；</p>
  </li>
  <li>
    <p>密碼：
早期 Unix 系統的密碼就是放在這欄位上！但是因為這個檔案的特性是所有的程序都能夠讀取，這樣一來很容易造成密碼資料被竊取， 因此後來就將這個欄位的密碼資料給他改放到 /etc/shadow 中了。所以這裡你會看到一個『 x 』！</p>
  </li>
  <li>
    <p>UID：
<img src="https://lh5.googleusercontent.com/kZDKBDkeEs8mmyEsJNC78JD5tTmtdtmU72h3ZnjMt1c=w1743-h1090-no" alt="資料來源：鳥哥"></p>
  </li>
  <li>GID
這個與 /etc/group 有關！其實 /etc/group 的觀念與 /etc/passwd 差不多，只是他是用來規範群組名稱與 GID 的對應而已！</li>
  <li>使用者資訊說明欄
這個欄位基本上並沒有什麼重要用途，只是用來解釋這個帳號的意義而已</li>
  <li>家目錄
root 的家目錄在 /root
預設的使用者家目錄在 /home/yourIDname</li>
  <li>Shell
當使用者登入系統後就會取得一個 Shell 來與系統的核心溝通以進行使用者的操作任務。那為何預設 shell 會使用 bash 呢？就是在這個欄位指定的囉！ 這裡比較需要注意的是，有一個 shell 可以用來替代成讓帳號無法取得 shell 環境的登入動作！那就是 /sbin/nologin 這個東西！這也可以用來製作純 pop 郵件帳號者的資料呢！</li>
</ol>

<h3 id="etcshadow"><code class="highlighter-rouge">/etc/shadow</code></h3>
<p>早期的密碼也有加密過，但卻放置到 /etc/passwd 的第二個欄位上！這樣一來很容易被有心人士所竊取的， 加密過的密碼也能夠透過暴力破解法去 try and error (試誤) 找出來！因為這樣的關係，所以後來發展出將密碼移動到 /etc/shadow 這個檔案分隔開來的技術， 而且還加入很多的密碼限制參數在 /etc/shadow 裡頭呢</p>

<p>詳細內容請看：
<a href="http://linux.vbird.org/linux_basic/0410accountmanager.php#shadow_file">鳥哥：/etc/shadow 檔案結構</a></p>

<h3 id="etcgroup"><code class="highlighter-rouge">/etc/group</code></h3>
<p>Control of group membership is administered through the <code class="highlighter-rouge">/etc/group</code> file, which shows a list of groups and their members.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ubuntu@ip-172-31-27-94:~$ head -n 4 /etc/group
root:x:0:
daemon:x:1:
bin:x:2:
sys:x:3:
</code></pre></div></div>
<p>這個檔案每一行代表一個群組，也是以冒號『:』作為欄位的分隔符號，共分為四欄，每一欄位的意義是：</p>

<ol>
  <li>
    <p>群組名稱：
就是群組名稱啦！</p>
  </li>
  <li>
    <p>群組密碼：
通常不需要設定，這個設定通常是給『群組管理員』使用的，目前很少有這個機會設定群組管理員啦！ 同樣的，密碼已經移動到 /etc/gshadow 去，因此這個欄位只會存在一個『x』而已；</p>
  </li>
  <li>
    <p>GID：
就是群組的 ID 啊。我們 /etc/passwd 第四個欄位使用的 GID 對應的群組名，就是由這裡對應出來的！</p>
  </li>
  <li>
    <p>此群組支援的帳號名稱：
我們知道一個帳號可以加入多個群組，那某個帳號想要加入此群組時，將該帳號填入這個欄位即可。 舉例來說，如果我想要讓 dmtsai 也加入 root 這個群組，那麼在第一行的最後面加上『,dmtsai』，注意不要有空格， 使成為『 root<img class="emoji" title=":x:" alt=":x:" src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png" height="20" width="20">0:root,dmtsai 』就可以囉～</p>
  </li>
</ol>

<h1 id="3-adding-and-removing-users">3. Adding and Removing Users</h1>

<p>Only the <em>root user</em> can add and remove users and groups.</p>

<h3 id="useradd">useradd</h3>

<p>In the simplest form an account for the new user turkey would be done with:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo useradd turkey
</code></pre></div></div>
<p>which by default sets the home directory to <code class="highlighter-rouge">/home/turkey</code>, populates it with some basic files (copied from /etc/skel) and adds a line to /etc/passwd such as:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>turkey:x:502:502::/home/turkey:/bin/bash
</code></pre></div></div>
<p>and sets the default shell to <code class="highlighter-rouge">/bin/bash</code></p>

<h3 id="userdel-and-userdel--r">userdel and userdel -r</h3>
<p>Removing a user account is as easy as typing userdel turkey However, this will leave the /home/turkey directory intact. This might be useful if it is a temporary inactivation. To remove the home directory while removing the account one needs to use the <code class="highlighter-rouge">-r</code> option to userdel.</p>

<h3 id="id">id</h3>
<p>Typing id with no argument gives information about the current user, as in:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ id
uid=500(george) gid=500(george) groups=106(fuse),500(george)
</code></pre></div></div>
<p>If given the name of another user as an argument, id will report information about that other user.</p>

<p><img src="https://lh5.googleusercontent.com/-DlvXntyuZuo/VB5Yp-Bv8eI/AAAAAAAAC_M/na_IAEG8CLg/w1755-h153-no/Screen%2BShot%2B2014-09-21%2Bat%2B12.46.47.png" alt=""></p>

<h3 id="usermod">usermod</h3>
<p>所謂這『人有失手，馬有亂蹄』，您說是吧？所以囉，當然有的時候會『不小心』在 useradd 的時候加入了錯誤的設定資料。或者是，在使用 useradd 後，發現某些地方還可以進行細部修改。 此時，當然我們可以直接到 /etc/passwd 或 /etc/shadow 去修改相對應欄位的資料， 不過，Linux 也有提供相關的指令讓大家來進行帳號相關資料的微調呢～那就是 usermod 囉～</p>

<p><a href="http://linux.vbird.org/linux_basic/0410accountmanager.php#usermod">鳥哥：usermod</a></p>

<h1 id="4-adding-and-removing-groups">4. Adding and Removing Groups</h1>

<h3 id="groupadd">groupadd</h3>

<p>Adding a new group is done with groupadd:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo /usr/sbin/groupadd anewgroup
</code></pre></div></div>
<h3 id="groupdel">groupdel</h3>

<p>The group can be removed with</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo /usr/sbin/groupdel anewgroup
</code></pre></div></div>

<h3 id="groups">groups</h3>
<p>輸入<code class="highlighter-rouge">groups turkey</code>查看turkey的group</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$groups turkey
turkey : turkey
</code></pre></div></div>
<p>得到turkey : turkey，代表預設的群組是自己。</p>

<h3 id="使用usermod修改群組">使用usermod修改群組</h3>
<p>Adding a user to an already existing group is done with usermod.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo /usr/sbin/usermod -G anewgroup turkey
$ groups turkey
turkey: turkey anewgroup
</code></pre></div></div>

<p>-g  ：後面接初始群組，修改 /etc/passwd 的第四個欄位，亦即是 GID 的欄位！
-G  ：後面接次要群組，修改這個使用者能夠支援的群組，修改的是 /etc/group 囉～</p>

<h1 id="5-the-root-account">5. The root Account</h1>
<p>The root account is very powerful and has full access to the system. Other operating systems often call this the administrator account; in Linux it is often called the superuser account.</p>

<h3 id="su">su</h3>
<p>switch or substitute user</p>

<h3 id="sudo">sudo</h3>
<p>sudo 可以讓你以其他用戶的身份執行指令 (通常是使用 root 的身份來執行指令)</p>

<h3 id="etcsudoers">/etc/sudoers</h3>

<p>sudo configuration files are stored in the <code class="highlighter-rouge">/etc/sudoers</code> file and in the <code class="highlighter-rouge">/etc/sudoers.d/</code> directory. By default, the sudoers.d directory is empty.</p>

<h1 id="6startup-files">6.Startup Files</h1>

<h3 id="etc">/etc</h3>
<p>In Linux, the command shell program (generally bash)  uses one or more startup files to configure the environment. Files in the <code class="highlighter-rouge">/etc</code> directory <strong>define global settings for all users</strong> while Initialization files in the user’s home directory can include and/or override the global settings.</p>

<h3 id="etcprofilelogin-shell-reading-it">
<code class="highlighter-rouge">/etc/profile</code>(login shell reading it)</h3>
<p>When you first login to Linux, /etc/profile is read and evaluated, after which the following files are searched (if they exist) in the listed order:</p>

<ol>
  <li>~/.bash_profile</li>
  <li>~/.bash_login</li>
  <li>~/.profile</li>
</ol>

<p>The Linux login shell evaluates whatever startup file that it comes across first and ignores the rest. This means that if it finds ~/.bash_profile, it ignores ~/.bash_login and ~/.profile. Different distributions may use different startup files.</p>

<h3 id="bashrc-non-login-shell-reading-it">
<code class="highlighter-rouge">~/.bashrc</code> (non-login shell reading it)</h3>
<p>However, every time you create a new shell, or terminal window, etc., you do not perform a full system login; only the ~/.bashrc file is read and evaluated.</p>

<h3 id="bash_history"><code class="highlighter-rouge">~/.bash_history</code></h3>
<p>還記得我們在歷史命令提到過這個檔案吧？預設的情況下， 我們的歷史命令就記錄在這裡啊！而這個檔案能夠記錄幾筆資料，則與 HISTFILESIZE 這個變數有關啊。每次登入 bash 後，bash 會先讀取這個檔案，將所有的歷史指令讀入記憶體， 因此，當我們登入 bash 後就可以查知上次使用過哪些指令囉。至於更多的歷史指令， 請自行回去參考喔！</p>

<h2 id="login-shell-和-no-login-shell">login shell 和 no-login shell</h2>
<p>“login shell” 代表用戶登入, 比如使用“su -“ 命令, 或者用ssh 連接到某一個服務器上, 都會使用該用戶默認shell 啟動login shell 模式.該模式下的shell會去自動執行/etc/profile和~/.profile文件,但不會執行任何的bashrc文件,所以一般再/etc/profile或者~/.profile裡我們會手動去source bashrc文件.而no-login shell 的情況是我們在終端下直接輸入bash 或者bash -c “CMD” 來啟動的shell.該模式下是不會自動去運行任何的profile 文件.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://lukahuang.com/tags/#edx-linux-foundation" class="page__taxonomy-item" rel="tag">EDX Linux Foundation</a><span class="sep">, </span>
    
      
      
      <a href="https://lukahuang.com/tags/#linux" class="page__taxonomy-item" rel="tag">Linux</a>
    
    </span>
  </p>




        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2014-09-13T07:50:00+00:00">September 13, 2014</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="https://lukahuang.com/edx-linux-foundation-ch-8-filesystem/" class="pagination--pager" title="EDX Linux Foundation Ch 8：Filesystem
">Previous</a>
    
    
      <a href="https://lukahuang.com/edx-linux-foundation-ch-9-environment-variable/" class="pagination--pager" title="EDX Linux Foundation Ch 9：User Environment Section 2 Environment Variables
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  
    <a class="archive__item" href="https://lukahuang.com/introduction-to-gitops-via-argocd/" rel="permalink">
  
    <img class="archive__item-image" src="/assets/images/icon/kubernetes.png" alt="">

    <div class="archive__item-title">
      ArgoCD - 透過 ArgoCD 認識 GitOps

    </div>
  </a>
</div>
        
          



<div class="grid__item">
  
    <a class="archive__item" href="https://lukahuang.com/introduction-to-open-source-guild/" rel="permalink">
  
    <img class="archive__item-image" src="/assets/images/icon/cat.png" alt="">

    <div class="archive__item-title">
      從 Github 開源指南｜學習如何貢獻開源專案

    </div>
  </a>
</div>
        
          



<div class="grid__item">
  
    <a class="archive__item" href="https://lukahuang.com/tldr/" rel="permalink">
  
    <img class="archive__item-image" src="/assets/images/icon/cat.png" alt="">

    <div class="archive__item-title">
      TLDR 命令列神兵｜Linux 入門必裝

    </div>
  </a>
</div>
        
          



<div class="grid__item">
  
    <a class="archive__item" href="https://lukahuang.com/lens-the-ide-for-kubernetes/" rel="permalink">
  
    <img class="archive__item-image" src="/assets/images/icon/kubernetes.png" alt="">

    <div class="archive__item-title">
      Kubernetes IDE - Lens 用圖形化介面管理 K8S

    </div>
  </a>
</div>
        
      </div>
    </div>
  
  
</div>


  <div class="page__footer">
    <footer>
      <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
      <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
      <li><a href="https://github.com/lukahuang"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    
    <li><a href="https://lukahuang.com/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2021 Luka Huang. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

    </footer>
  </div>

  <script src="https://lukahuang.com/assets/js/jquery.min.js"></script>

  <script src="https://lukahuang.com/assets/js/main.min.js"></script>









  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-123551558-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>






</body>

</html>